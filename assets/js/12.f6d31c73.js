(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{185:function(t,e,n){},189:function(t,e,n){"use strict";var i=n(185);n.n(i).a},191:function(t,e,n){"use strict";var i={name:"GuluButton",components:{"g-icon":n(187).a},props:{icon:{type:String},loading:{type:Boolean,default:!1},iconPosition:{type:String,default:"left",validator:function(t){return"left"===t||"right"===t}}}},o=(n(189),n(1)),s=Object(o.a)(i,function(){var t,e=this,n=e.$createElement,i=e._self._c||n;return i("button",{staticClass:"g-button",class:(t={},t["icon-"+e.iconPosition]=!0,t),on:{click:function(t){return e.$emit("click")}}},[e.icon&&!e.loading?i("g-icon",{staticClass:"icon",attrs:{name:e.icon}}):e._e(),e._v(" "),e.loading?i("g-icon",{staticClass:"loading icon",attrs:{name:"loading"}}):e._e(),e._v(" "),i("div",{staticClass:"text"},[e._t("default")],2)],1)},[],!1,null,"3b5ab564",null);e.a=s.exports},233:function(t,e,n){},272:function(t,e,n){"use strict";var i=n(233);n.n(i).a},282:function(t,e,n){"use strict";n.r(e);var i=n(191),o=(n(48),n(9)),s=(n(188),n(187));var a={get:function(){},post:function(t,e){return function(t,e,n){var i=new XMLHttpRequest;i.open(t,e),i.onload=function(){n.success&&n.success(i.response)},i.onerror=function(){n.fail&&n.fail(i,i.response)},i.send(n.data)}("post",t,e)},put:function(){},delete:function(){},patch:function(){}},l={name:"GuluUploader",components:{GIcon:s.a},props:{fileList:{type:Array,default:function(){return[]},required:!0},name:{type:String,required:!0},action:{type:String,required:!0},method:{type:String,default:"POST"},parseResponse:{type:Function,required:!0},sizeLimit:{type:Number}},data:function(){return{url:"about:blank"}},methods:{onRemove:function(t){if(window.confirm("确认删除？")){var e=Object(o.a)(this.fileList),n=this.fileList.indexOf(t);e.splice(n,1),this.$emit("update:fileList",e)}},onClickUpload:function(){var t=this,e=this.createInput();e.addEventListener("change",function(){t.uploadFile(e.files),e.remove()}),e.click()},createInput:function(){this.$refs.trigger.innerHTML="";var t=document.createElement("input");return t.type="file",t.multiple=!0,this.$refs.trigger.appendChild(t),t},beforeUploadFile:function(t,e){for(var n=[],i=0;i<t.length;i++){var s=t[i],a=s.size,l=s.type;if(a>this.sizeLimit)return this.$emit("error","文件"+e[i]+"大于2MB"),!1;n.push({name:e[i],size:a,type:l,status:"uploading"})}return this.$emit("update:fileList",Object(o.a)(this.fileList).concat(n)),!0},uploadFile:function(t){for(var e=this,n=[],i=0;i<t.length;i++){var o=t[i],s=this.gengerateName(o.name);n[i]=s}if(this.beforeUploadFile(t,n))for(var a=function(i){var o=t[i],s=new FormData;s.append(e.name,o),e.doUploadFile(s,function(t){e.url=e.parseResponse(t),e.afterUploadFile(n[i],e.url)},function(t){e.uploadeError(t,n[i])})},l=0;l<t.length;l++)a(l)},uploadeError:function(t,e){var n=this.fileList.filter(function(t){return t.name===e})[0],i=this.fileList.indexOf(n),o=JSON.parse(JSON.stringify(this.fileList));o[i].status="fail",this.$emit("update:fileList",o);var s="";0===t.status&&(s="网络无法连接"),this.$emit("error",s)},afterUploadFile:function(t,e){var n=this.fileList.filter(function(e){return e.name===t})[0],i=this.fileList.indexOf(n),o=JSON.parse(JSON.stringify(this.fileList));o[i].status="success",o[i].url=e,this.$emit("update:fileList",o)},doUploadFile:function(t,e,n){a[this.method.toLowerCase()](this.action,{success:e,fail:n,data:t})},gengerateName:function(t){for(;this.fileList.filter(function(e){return e.name===t}).length>0;){var e=t.lastIndexOf("."),n=t.substring(0,e),i=t.substring(e);t=n+"(1)"+i}return t}}},r=(n(272),n(1)),u=Object(r.a)(l,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"g-uploader"},[n("div",{on:{click:t.onClickUpload}},[t._t("default")],2),t._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],ref:"trigger"}),t._v(" "),n("ol",{staticClass:"g-uploader-filelist"},t._l(t.fileList,function(e){var i;return n("li",{key:e.name},["uploading"===e.status?[n("g-icon",{staticClass:"g-uploader-loading",attrs:{name:"loading"}},[t._v("菊花")])]:0===e.type.indexOf("image")?[n("img",{staticClass:"g-uploader-image",attrs:{src:e.url}})]:[n("div",{staticClass:"g-uploder-image-default"})],t._v(" "),n("span",{staticClass:"g-uploader-name",class:(i={},i[e.status]=e.status,i)},[t._v(t._s(e.name))]),t._v(" "),n("span",{staticClass:"g-uploader-remove",on:{click:function(n){return t.onRemove(e)}}},[t._v("Remove")])],2)}),0)])},[],!1,null,"439dae78",null).exports,p=n(186),c={components:{"g-button":i.a,"g-upload":u,"s-wrapper":p.default},data:function(){return{uplodefilelist:[],code1:'<g-upload\n  action="http://localhost:3000/upload"\n  name="filename"\n  :fileList.sync="uplodefilelist"\n  :parseResponse="uploaderParseResponse"\n>\n  <g-button icon="upload">Upload</g-button>\n</g-upload>\n\nmethods: {\n  uploaderParseResponse(response) {\n    let obj = JSON.parse(response);\n    return `http://localhost:3000/preview/${obj.id}`;\n  }\n}',instruction2:"method: String类型。指定http请求方法。",code2:'<g-upload\n  action="http://localhost:3000/upload"\n  name="filename"\n  :fileList.sync="uplodefilelist"\n  :parseResponse="uploaderParseResponse"\n  method="POST"\n>\n  <g-button icon="upload">Upload</g-button>\n</g-upload>',instruction3:"sizeLimit: Number类型。前端限制文件大小。作用不大。",code3:'<g-upload\n  action="http://localhost:3000/upload"\n  name="filename"\n  :fileList.sync="uplodefilelist"\n  :parseResponse="uploaderParseResponse"\n  :size-limit="2*1024*1024"\n>\n  <g-button icon="upload">Upload</g-button>\n</g-upload>'}},methods:{errorinfo:function(t){alert(t)},uploaderParseResponse:function(t){var e=JSON.parse(t);return"http://localhost:3000/preview/".concat(e.id)}}},d=Object(r.a)(c,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("s-wrapper",{attrs:{title:"简单上传组件"}},[n("template",{slot:"component"},[n("g-upload",{attrs:{action:"http://localhost:3000/upload",name:"filename",fileList:t.uplodefilelist,parseResponse:t.uploaderParseResponse},on:{"update:fileList":function(e){t.uplodefilelist=e},"update:file-list":function(e){t.uplodefilelist=e}}},[n("g-button",{attrs:{icon:"upload"}},[t._v("Upload")])],1)],1),t._v(" "),n("pre",{attrs:{slot:"code"},slot:"code"},[n("code",[t._v(t._s(t.code1))])])],2),t._v(" "),n("s-wrapper",{attrs:{title:"method 选项",instruction:t.instruction2}},[n("template",{slot:"component"},[n("g-upload",{attrs:{action:"http://localhost:3000/upload",name:"filename",fileList:t.uplodefilelist,parseResponse:t.uploaderParseResponse,method:"POST"},on:{"update:fileList":function(e){t.uplodefilelist=e},"update:file-list":function(e){t.uplodefilelist=e}}},[n("g-button",{attrs:{icon:"upload"}},[t._v("Upload")])],1)],1),t._v(" "),n("pre",{attrs:{slot:"code"},slot:"code"},[n("code",[t._v(t._s(t.code2))])])],2),t._v(" "),n("s-wrapper",{attrs:{title:"sizeLimit 选项",instruction:t.instruction3}},[n("template",{slot:"component"},[n("g-upload",{attrs:{action:"http://localhost:3000/upload",name:"filename",fileList:t.uplodefilelist,parseResponse:t.uploaderParseResponse,"size-limit":2097152},on:{"update:fileList":function(e){t.uplodefilelist=e},"update:file-list":function(e){t.uplodefilelist=e}}},[n("g-button",{attrs:{icon:"upload"}},[t._v("Upload")])],1)],1),t._v(" "),n("pre",{attrs:{slot:"code"},slot:"code"},[n("code",[t._v(t._s(t.code3))])])],2)],1)},[],!1,null,null,null);e.default=d.exports}}]);